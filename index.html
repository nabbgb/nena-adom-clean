<!DOCTYPE html>
<html lang="fr">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nena Adom test - Aide à domicile</title>
  <link rel="stylesheet" href="style.css">
</head>

<style>
/* ====== Variables couleurs Nena Adom ====== */
:root{
  --na-blue: #004AAD;
  --na-yellow: #FFEBA4; /* jaune pastel */
}

/* ====== Base existante ====== */


header h1 {
  font-size: 2em;
  margin: 0;
  font-weight: normal;
  font-family: Arimo;
}

header h2 {
  font-size: 1.7em;
  font-weight: normal;
  margin-bottom: 40px;
}

.main-section {
  display: flex;
  align-items: stretch;
  background-color: #fafafa;
  margin-bottom: 30px;
  margin-top: 20px;
  overflow: hidden;
  margin-right:60px;
  margin-left:60px;
  position: relative;           /* ← nécessaire pour les formes */
  isolation: isolate;           /* empêche les z-index de fuir */
}

.main-section img {
  width: 70%;
  height: auto;
  object-fit: cover;
  display: block;
  position: relative;           /* passe au-dessus des blobs */
  z-index: 1;
}

.main-text {
  width: 100%;
  padding: 40px;
  text-align: justify;
  display: flex;
  flex-direction: column;
  justify-content: center;
  position: relative;           /* passe au-dessus des blobs */
  z-index: 1;
}

.main-text h3 {
  font-size: 2em;
  font-weight: normal;
  margin-bottom: 10px;
  align-items: center;
  text-align: center;
  line-height: 1.2; /* Espacement entre les lignes */
  justify-content: center;
  font-family: Arimo;
  margin-top: 10px;
}

.main-text h2 {
  text-align : center;
  font-size: 1em;
  font-weight: normal;
  margin: 0;
}

.main-text p {
  line-height: 1.5em;
  margin-left: 28px;
  margin-right: 28px;
}

/* ====== Blobs décoratifs sur toute la page ====== */
/* 1) Blob HÉRO : gros ovale bleu + pastille jaune */
.main-section::before{
  content:"";
  position:absolute;
  left:-22vw;
  top:-12vw;
  width:65vw;
  height:65vw;
  max-width:920px;
  max-height:920px;
  background: var(--na-blue);
  opacity:.08;                  /* douceur */
  border-radius: 50% 45% 55% 50% / 55% 50% 45% 50%;
  transform: rotate(-12deg);
  z-index:0;
  pointer-events:none;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,.06));
}

.main-section::after{
  content:"";
  position:absolute;
  right:-8vw;
  bottom:-6vw;
  width:18vw;
  height:18vw;
  max-width:260px;
  max-height:260px;
  background: var(--na-yellow);
  opacity:.35;
  border-radius:50%;
  transform: rotate(8deg);
  z-index:0;
  pointer-events:none;
  filter: drop-shadow(0 8px 22px rgba(0,0,0,.06));
}

/* 2) SECTION “DE QUOI AVEZ-VOUS BESOIN ?” / grille des services */
.services-grid{
  position:relative;
  isolation:isolate;
}



/* 3) Barre de recherche – petit accent jaune derrière le titre */
.search-section{
  position:relative;
  isolation:isolate;
}
.search-section::before{
  content:"";
  position:absolute;
  left:50%;
  top:-14px;
  transform:translateX(-50%) rotate(-3deg);
  width:280px;
  height:28px;
  background: var(--na-yellow);
  opacity:.35;
  border-radius: 999px;
  z-index:0;
  pointer-events:none;
}

/* 4) Section contact – grand ruban bleu en arrière-plan */
.contact-section{
  position:relative;
  isolation:isolate;
  overflow: hidden;
}
.contact-section::before{
  content:"";
  position:absolute;
  right:-25vw;
  top:-8vw;
  width:58vw;
  height:58vw;
  max-width:900px;
  max-height:900px;
  background: var(--na-blue);
  opacity:.07;
  border-radius: 46% 54% 50% 50% / 54% 46% 50% 50%;
  transform: rotate(14deg);
  z-index:0;
  pointer-events:none;
}

/* 5) Section partenaires – halo bicolore doux */
.partners-section{
  position:relative;
  isolation:isolate;
}
.partners-section::before{
  content:"";
  position:absolute;
  left:-10vw;
  bottom:-6vw;
  width:40vw;
  height:40vw;
  max-width:520px;
  max-height:520px;
  background: radial-gradient(100% 100% at 50% 50%, rgba(0,74,173,.12) 0%, rgba(0,74,173,0) 70%),
              radial-gradient(100% 100% at 70% 30%, rgba(255,235,164,.45) 0%, rgba(255,235,164,0) 70%);
  border-radius:50%;
  z-index:0;
  pointer-events:none;
}

/* 6) Carte – petite pastille bleue pour rappeler la charte */
.map-section{
  position:relative;
  isolation:isolate;
}
.map-section::after{
  content:"";
  position:absolute;
  right:6vw;
  top:-24px;
  width:120px;
  height:120px;
  background: var(--na-blue);
  opacity:.08;
  border-radius:50%;
  z-index:0;
  pointer-events:none;
}

/* ====== Couche décor FIXE (figée au scroll) ====== */
.na-fixed-decor{
  position: fixed;
  inset: 0;
  z-index: 0;            /* sous le contenu */
  pointer-events: none;  /* jamais cliquable */
}

.na-fixed-decor .blob{
  position: absolute;
  will-change: transform;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,.06));
}

/* GROSSE TACHE BLEUE EN HAUT-GAUCHE */
.blob--tl{
  width: 48vw; height: 48vw;
  left: -18vw; top: -12vw;
  background: var(--na-blue);
  opacity: .085;
  border-radius: 52% 48% 57% 43% / 53% 47% 52% 48%;
  transform: rotate(-12deg);
}

/* PASTILLE JAUNE EN HAUT-DROITE */
.blob--tr{
  width: 24vw; height: 24vw;
  right: -10vw; top: 8vh;
  background: var(--na-yellow);
  opacity: .35;
  border-radius: 50%;
  transform: rotate(6deg);
  filter: drop-shadow(0 8px 22px rgba(0,0,0,.06));
}

/* GRAND VOILE BLEU FAIBLE OPACITÉ (CENTRE) */
.blob--c1{
  width: 60vw; height: 60vw;
  left: 18vw; top: 42vh;
  background: var(--na-blue);
  opacity: .06;
  border-radius: 46% 54% 50% 50% / 54% 46% 50% 50%;
  transform: rotate(14deg);
}

/* BLOB BLEU EN BAS-DROITE */
.blob--br{
  width: 36vw; height: 36vw;
  right: -12vw; bottom: -8vw;
  background: var(--na-blue);
  opacity: .09;
  border-radius: 55% 45% 50% 50% / 44% 56% 50% 50%;
  transform: rotate(-8deg);
}

/* PASTILLE JAUNE EN BAS-GAUCHE */
.blob--bl{
  width: 20vw; height: 20vw;
  left: 6vw; bottom: 18vh;
  background: var(--na-yellow);
  opacity: .4;
  border-radius: 50%;
  transform: rotate(8deg);
  filter: drop-shadow(0 8px 22px rgba(0,0,0,.06));
}

/* Le contenu passe AU-DESSUS des blobs */
.container,
.contact-section,
.partners-section,
.map-section,
footer{
  position: relative;
  z-index: 1;
}

/* ====== Responsive : on allège les formes sur mobile ====== */
@media (max-width: 768px){
  .center-header {
    margin-top:5px;
    margin-bottom:5px;
  }

  .center-header h2{
    margin-bottom: 20px;
  }
  .main-section{
    margin-top:0;
    margin-left:16px;
    margin-right:16px;
  }
  .main-section::before{
    left:-40vw;
    top:-24vw;
    width:120vw;
    height:120vw;
    opacity:.09;
  }
  .main-section::after{
    right:-18vw;
    bottom:-12vw;
    width:36vw;
    height:36vw;
    opacity:.35;
  }
  .services-grid::before{
    width:92vw;
    height:260px;
    top:-30px;
    opacity:1;
  }
  .contact-section::before{
    right:-40vw;
    top:-20vw;
    width:100vw;
    height:100vw;
    opacity:.08;
  }
  .map-section::after{
    width:80px; height:80px;
    right:4vw; top:-14px;
  }

  .phone-call-button {
    width: 45vw;
  }

  .contact-right {
    margin-top:0px;
  }
  /* Déco fixe – version mobile */
  .na-fixed-decor .blob{ opacity: .09; } /* un chouïa plus visible sur petit écran */

  .blob--tl{
    width: 55vw; height: 110vw;
    left: -45vw; top: 32vw;
  }

  .blob--tr{
    width: 36vw; height: 36vw;
    right: -16vw; top: 10vh;
  }

  .blob--c1{ display: none; } /* on allège pour perf/lecture */

  .blob--br{
    width: 70vw; height: 70vw;
    right: -40vw; bottom: -26vw;
  }

  .blob--bl{
    width: 44vw; height: 44vw;
    left: -12vw; bottom: 18vh;
  }

}



/* ====== Bouton Appel ====== */
.phone-call-button {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 12px 20px;
  background-color: #28a745; /* vert bouton */
  color: white;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: none;
  border-radius: 50px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.phone-call-button:hover {
  background-color: #218838; /* vert foncé au survol */
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}

.phone-call-button svg {
  width: 22px;
  height: 22px;
  fill: white;
}
/* On coupe les anciens pseudo-éléments décoratifs */
.main-section::before,
.main-section::after,
.search-section::before,
.contact-section::before,
.partners-section::before,
.map-section::after{
  content: none !important;
}

/* 1) Donne une “priorité” de pile à la zone recherche */
.search-section{
  position: relative;  /* tu l’as déjà, on garde */
  z-index: 10;         /* > 1 pour passer devant les autres sections */
}

/* 2) Assure que la liste de suggestions survole tout */
.ta-wrap{ 
  position: relative;  /* conteneur du dropdown */
  z-index: 10;
}
.ta-list{
  z-index: 10000;      /* le dropdown lui-même, tout en haut */
}

/* (optionnel mais propre) garde les autres sections derrière */
.contact-section,
.partners-section,
.map-section{
  position: relative;
  z-index: 1;
}

.partners-track{
  display: flex;
  align-items: center;
  gap: 24px;
  overflow: hidden;     /* obligatoire pour le ruban infini */
  white-space: nowrap;  /* au cas où */
}

.partners-track img{
  display: block;       /* évite l’espace baseline */
  height: 56px;         /* mets une hauteur fixe si tu peux, c’est plus robuste */
  width: auto;
}
@media (max-width: 768px){
  .partners-track img{
  height: 85px;
  }
  
}

/* Masquer les clones uniquement sur desktop */
@media (min-width: 769px){
  .partners-track [data-clone="1"]{
    display: none !important;
  }

  /* ✅ Rétablit une taille confortable des logos sur ordi */
  .partners-track img{
    height: 120px;   /* augmente si tu veux (ex: 90px ou 100px) */
    width: auto;
  }

  /* Un peu plus d’espace entre logos si besoin */
  .partners-track{
    gap: 32px;      /* ajuste à ton goût (ex: 40px) */
    padding-bottom: 45px;
  }
}

/* Liste en portail (toujours au-dessus) */
.ta-portal{
  position: fixed !important;
  z-index: 2147483647 !important; /* top de top */
}


</style>

<body>

  <!-- DÉCOR FIXE (ne bouge pas au scroll) -->
  <div class="na-fixed-decor" aria-hidden="true">
    <span class="blob blob--c1"></span>
    <span class="blob blob--br"></span>
    <span class="blob blob--bl"></span>
  </div>

  <div class="container">
    <header class="center-header">
      <h1>NENA ADOM</h1>
      <h2>Services d'aide à domicile</h2>
    </header>

    <section class="main-section">
      <img src="images/accueil/slogan-accueil.jpg" alt="Photo d'une dame âgée et d'une jeune femme souriante">
      <div class="main-text">
        <h2>PARIS</h2>
        <h3>Offrez le meilleur<br> accompagnement à vos proches</h3>
        <p>
        Découvrez nos services personnalisés d'aide à domicile, conçus pour répondre précisément aux besoins uniques de chaque personne âgée.
        </p>
      </div>
    </section>

    <div class="section-title center-title">De quoi avez-vous besoin ?</div>

    <section class="services-grid">

        <div class="service-cell">
          <div class="service-title-box">
            <h2>Aide à domicile aux personnes âgées</h2>
          </div>
          <a href="pages/services.html" class="service-link">
            <div class="service-content-box">
              <img src="images/accueil/pictures-cellules (1).png" alt="Aide à domicile">
              <div class="service-text">
                Afin d'assurer leur autonomie et leur dignité et d’offrir une tranquillité d'esprit totale aux proches aidants, nous proposons une gamme de services complète pour les tâches quotidiennes, y compris la toilette, l'aide au lever et au coucher, courses et préparation des repas, le ménage et le repassage.
                <br><button class="read-more-btn" onclick="expandFirstQuestion()">En savoir plus</button>
              </div>
            </div>
          </a>
        </div>

        <div class="service-cell">
          <div class="service-title-box">
            <h2>S’informer sur les aides financières </h2>
          </div>
          <a href="pages/aides.html" class="service-link">
            <div class="service-content-box">
              <img src="images/accueil/pictures-cellules (4).png" alt="Aides financières">
              <div class="service-text">
                Différentes aides financières existent pour rendre les services d’aide à domicile accessibles et offrir aux personnes âgées la possibilité de continuer à vivre chez elles malgré une perte
                d'autonomie. Notre équipe vous accompagne afin que vous puissiez bénéficier pleinement de vos droits. 
                <br><button class="read-more-btn" onclick="expandFirstQuestion()">En savoir plus</button>
              </div>
            </div>
          </a>
        </div>

        <div class="service-cell">
          <div class="service-title-box">
            <h2> Accompagnement après une hospitalisation</h2>
          </div>
          <a href="pages/hospitalisation.html" class="service-link">
            <div class="service-content-box">
              <img src="images/accueil/pictures-cellules (2).png" alt="Hospitalisation">
              <div class="service-text">
                Notre objectif est de favoriser le retour à domicile des patients. Notre équipe pluridisciplinaire prend entièrement en charge le patient, créant un environnement calme et adapté à ses besoins uniques. Facilitant également la logistique, Nena Adom s'occupe de la livraison du matériel médical. 
                <br><button class="read-more-btn" onclick="expandFirstQuestion()">En savoir plus</button>              
              </div>
            </div>
          </a>
        </div>

        <div class="service-cell">
          <div class="service-title-box">
            <h2>Mieux comprendre ma pathologie</h2>
          </div>
          <a href="pages/pathologie.html" class="service-link">
            <div class="service-content-box">
              <img src="images/accueil/pictures-cellules (3).png" alt="Pathologie">
              <div class="service-text">
                Pour les patients tout comme leurs proches aidants, bien vivre avec la maladie, passe avant tout par une bonne compréhension, vous trouverez ici à votre disposition des ressources claires et accessibles sur les pathologies les plus courantes chez les personnes âgées (Parkinson, Alzheimer…) 
                <br><button class="read-more-btn" onclick="expandFirstQuestion()">En savoir plus</button>
              </div>
            </div>
          </a>
        </div>

    </section>

<!-- Barre de recherche -->
  <section class="search-section center-title" style="margin-top:40px; text-align: center;">
    <h2 class="center-title">BESOIN D'UN RENSEIGNEMENT PRÉCIS ?</h2>
      <input type="text" id="searchInput" placeholder="Tapez un mot-clé..." style="padding:10px; width:90%; max-width:400px; border-radius:8px; border:1px solid #ccc; margin:10px auto;">
      <button onclick="searchSite()" style="padding:10px 20px; border-radius:8px; background-color:#004aad; color:white; border:none;">Rechercher</button>
      <ul id="results" style="margin-top:15px; list-style:none; padding-left:0;"></ul>
  </section>

  </div>

  <section class="contact-section">
  <div class="contact-right">
    <p class="contact-text">
      Contactez-nous dès aujourd'hui pour discuter de la manière dont nous pouvons améliorer la qualité de vie de vos proches grâce à nos services d'aide à domicile.
    </p>

    <p>Prenez rendez-vous dès aujourd’hui par téléphone :</p>

    <a href="tel:0605873735" class="phone-call-button">
      <!-- Icône téléphone -->
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M6.62 10.79a15.053 15.053 0 006.59 6.59l2.2-2.2a1 
                1 0 011.11-.21c1.21.49 2.54.76 3.93.76a1 
                1 0 011 1v3.5a1 1 0 01-1 1C10.61 
                22.5 1.5 13.39 1.5 2.5a1 1 0 
                011-1H6a1 1 0 011 1c0 1.39.26 
                2.72.76 3.93a1 1 0 01-.21 1.11l-2.2 2.2z"/>
      </svg>
      +33 6 05 87 37 35
    </a>


    <p class="contact-text-1">Chez Nena Adom, nous nous engageons à fournir un service d'accompagnement de fin de vie exceptionnel, apportant soutien, confort, et compassion à chaque étape du chemin. Faites le choix de la tranquillité d'esprit en nous choisissant comme partenaire dans cette étape délicate de la vie. Contactez-nous dès aujourd'hui pour en savoir plus sur nos services et comment nous pouvons accompagner vos proches.</p>
  </div>

  <div class="contact-left">
    <h2 class="contact-title">ENVIE D’ÉCHANGER ?</h2>
    <img src="images/accueil/cta-picture.png" alt="Illustration échange téléphone">
  </div>
</section>

<section class="partners-section">
  <h2>NOS PARTENAIRES</h2>
  <div class="partners-track">
      <div class="partner-tooltipv2">
          <a href="tel:0698332521" target="_blank">
              <img src="images/partenaires/sosmedecins.png" alt="Médecin Partenaire">
          </a>
          <div class="tooltip-textv2">
              En cas d'imprévu ou d'un pépin physique, appelez notre médecin partenaire, qui saura vous guider et vous permettre d'adopter les bons gestes dans les meilleurs délais.
          </div>
      </div>

      <div class="partner-tooltipv2">
          <a href="tel:0665957019" target="_blank">
              <img src="images/partenaires/taxi.png" alt="Jek Services">
          </a>
          <div class="tooltip-textv2">
              Avec nous test, vous disposez d'un chauffeur expérimenté privé pour vous amener partout ou vous le souhaitez, que ce soit pour des rendez-vous médicaux ou pour tout autre sortie.        
          </div>
      </div>

      <div class="partner-tooltipv2">
          <a href="tel:0605873735" target="_blank">
              <img src="images/partenaires/audition.png" alt="Prothèse auditive">
          </a>
          <div class="tooltip-textv2">
              En cas de soucis auditif appuyez sur l'icone pour prendre contact avec notre partenaire
          </div>
      </div>

      <div class="partner-tooltipv2">
          <a href="tel:0605873735" target="_blank">
              <img src="images/partenaires/kiné.png" alt="Kinésithérapeute">
          </a>
          <div class="tooltip-textv2">
              Messages Messages Messages Messages Messages Messages Messages Messages
          </div>
      </div>

      <div class="partner-tooltipv2">
          <a href="tel:0605873735" target="_blank">
              <img src="images/partenaires/pharmacie.png" alt="Pharmacie">
          </a>
          <div class="tooltip-textv2">
              Messages Messages Messages Messages Messages Messages Messages Messages
          </div>
      </div>

  </div>
</section>

<section class="map-section">
  <iframe
    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2624.7243927791994!2d2.300351115673216!3d48.86986757928898!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47e66fc731d81b7d%3A0x9db9c7d6b73d8351!2s92%20Av.%20des%20Champs-%C3%89lys%C3%A9es%2C%2075018%20Paris!5e0!3m2!1sfr!2sfr!4v1718796584436!5m2!1sfr!2sfr"
    width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy"
    referrerpolicy="no-referrer-when-downgrade">
  </iframe>
</section>

<footer style="background-color: #ffffff; padding: 20px 0; text-align: center; font-size: 14px; color: #000000; border-top: 1px solid #ddd;">
  <p>© 2025 Nena Adom – Tous droits réservés</p>
  <p>
    SIRET : 95102803400019 – Site sans collecte de données<br>
    Hébergement : IONOS – 7 Place de la Gare, 57200 Sarreguemines, France
  </p>
  <p>
    <a href="mailto:contact@nenaadom.fr" style="color: #000000; text-decoration: underline;">contact@nenaadom.fr</a> |
    <a href="pages/mentions-legales.html" style="color: #000000; text-decoration: underline;">Mentions légales</a> |
    <a href="pages/faq.html" style="color: #000000; text-decoration: underline;">FAQ</a>
  </p>
</footer>



<script>
// ===== Recherche site : scan de pages + redirection auto =====
(function(){
  // Reprend ton tableau existant si présent, sinon fallback :
  const PAGES = (window.pagesToSearch && Array.isArray(window.pagesToSearch) && window.pagesToSearch.length)
    ? window.pagesToSearch
    : [
        { title: "Aides financières", url: "pages/aides.html" },
        { title: "Services à domicile", url: "pages/services.html" },
        { title: "Hospitalisation",   url: "pages/hospitalisation.html" },
        { title: "Pathologies",       url: "pages/pathologie.html" },
        { title: "FAQ",               url: "pages/faq.html" }
      ];

  const resultsList = document.getElementById("results");
  const input = document.getElementById("searchInput");

  function escapeRegExp(s){ return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }

  async function searchSite(){
    const keyword = (input.value || '').trim();
    if (!keyword){
      if (resultsList) resultsList.innerHTML = "<li>Veuillez entrer un mot-clé.</li>";
      return;
    }
    if (resultsList) resultsList.innerHTML = "Recherche en cours...";

    const qLower = keyword.toLowerCase();
    const matches = [];

    await Promise.all(PAGES.map(async page=>{
      try{
        const res = await fetch(page.url, { cache: "no-store" });
        const html = await res.text();
        const lower = html.toLowerCase();
        const firstIdx = lower.indexOf(qLower);
        if (firstIdx !== -1){
          const count = (lower.match(new RegExp(escapeRegExp(qLower), "g")) || []).length;
          matches.push({ page, firstIdx, count });
        }
      }catch(_){}
    }));

    if (matches.length === 0){
      if (resultsList) resultsList.innerHTML = "<li>Aucun résultat trouvé</li>";
      return;
    }

    // Choix du "meilleur" résultat : plus d'occurrences, puis position la plus tôt
    matches.sort((a,b) => b.count - a.count || a.firstIdx - b.firstIdx);

    // 🔁 Redirection immédiate vers la meilleure page
    window.location.href = matches[0].page.url + "?q=" + encodeURIComponent(keyword);

    // (Optionnel) on affiche aussi la liste complète sous la barre
    if (resultsList){
      resultsList.innerHTML = matches
        .map(m => `<li><a href="${m.page.url}?q=${encodeURIComponent(keyword)}">${m.page.title}</a> — ${m.count} occurrence(s)</li>`)
        .join("");
    }
  }

  // Entrée = lancer la recherche (même si aucune suggestion)
  input.addEventListener("keydown", (e)=>{
    if (e.key === "Enter"){ e.preventDefault(); searchSite(); }
  });

  // Expose la fonction si tu l’appelles ailleurs (bouton Rechercher)
  window.searchSite = searchSite;
})();
</script>

<script>
(function(){
  const track = document.querySelector('.partners-track');
  if (!track) return;

  // ====== Tunables ======
  const mq = window.matchMedia('(max-width: 768px)');
  const SPEED = 40;                   // px/s
  const RECHECK_DELAY_MS = 1800;      // safety fallback if decode never fires
  const RESUME_TOUCH_DELAY_MS = 600;

  // ====== State ======
  let running = false, rafId = null, lastTs = 0, cycle = 0;
  let ro = null; // ResizeObserver

  // --- Utilities ---
  function qChildren() { return Array.from(track.children).filter(n => !n.dataset.clone); }
  function clones()    { return Array.from(track.children).filter(n => n.dataset.clone === '1'); }

  function imagesIn(nodeList){
    return nodeList.flatMap(el => Array.from(el.querySelectorAll('img')));
  }

  // Wait until all images in the ORIGINAL set have a stable size
  function waitImagesReady(originals){
    const imgs = imagesIn(originals);

    // Hint browsers not to lazy-load this carousel
    imgs.forEach(img => {
      try { img.loading = 'eager'; } catch(e){}
      try { img.fetchPriority = 'high'; } catch(e){}
      try { img.decoding = 'async'; } catch(e){}
    });

    const promises = imgs.map(img => {
      if (img.complete && img.naturalWidth > 0) {
        // Try to decode anyway to ensure layout-ready on Safari
        return (img.decode ? img.decode().catch(()=>{}) : Promise.resolve());
      }
      return new Promise(resolve => {
        const done = () => { img.removeEventListener('load', done); img.removeEventListener('error', done);
          (img.decode ? img.decode().catch(()=>{}).finally(resolve) : resolve()); };
        img.addEventListener('load', done, {once:true});
        img.addEventListener('error', done, {once:true});
      });
    });

    // Safety timeout in case some images never fire
    const timeout = new Promise(resolve => setTimeout(resolve, RECHECK_DELAY_MS));
    return Promise.race([Promise.all(promises), timeout]).then(() => {
      // One microtask later, sizes should be final
      return new Promise(r => requestAnimationFrame(()=>r()));
    });
  }

  // Lock each original item’s width so late font/image swaps don’t move the loop point
  function lockWidths(originals){
    originals.forEach(el => {
      el.style.flex = '0 0 auto';
      el.style.width = el.getBoundingClientRect().width + 'px';
    });
  }
  function unlockWidths(originals){
    originals.forEach(el => { el.style.width = ''; el.style.flex = ''; });
  }

  function computeCycle(){
    // Using offsetLeft of first clone is fine once everything is measured
    const firstClone = track.querySelector('[data-clone="1"]');
    if (firstClone) return Math.round(firstClone.offsetLeft);
    return 0;
  }

  async function rebuild(){
    // 1) clear previous clones
    clones().forEach(n => n.remove());

    // 2) originals
    const originals = qChildren();

    // 3) make sure images are sized
    await waitImagesReady(originals);

    // 4) lock widths against late layout shifts
    lockWidths(originals);

    // 5) duplicate once
    originals.forEach(el => {
      const clone = el.cloneNode(true);
      clone.setAttribute('data-clone','1');
      // Prevent lazy on clones
      imagesIn([clone]).forEach(img => { try { img.loading='eager'; img.decoding='async'; } catch(e){} });
      track.appendChild(clone);
    });

    // 6) force reflow then compute loop point
    void track.offsetWidth;
    cycle = computeCycle();

    // 7) normalize scroll position inside the cycle
    if (cycle > 0) track.scrollLeft = track.scrollLeft % cycle;

    // 8) watch for size changes (fonts swap, orientation, etc.)
    if (ro) ro.disconnect();
    if ('ResizeObserver' in window) {
      ro = new ResizeObserver(() => {
        // If any item’s width changed, rebuild cleanly
        stop();
        unlockWidths(originals);
        rebuild().then(start);
      });
      originals.forEach(el => ro.observe(el));
    }
  }

  function shouldRun(){
    return mq.matches && track.scrollWidth > track.clientWidth;
  }

  function step(ts){
    if (!running) return;
    if (!lastTs) lastTs = ts;
    const dt = (ts - lastTs) / 1000; lastTs = ts;

    track.scrollLeft += SPEED * dt;
    if (cycle > 0 && track.scrollLeft >= cycle) track.scrollLeft -= cycle;

    rafId = requestAnimationFrame(step);
  }

  async function start(){
    if (running) return;
    if (!shouldRun()) { stop(); return; }
    track.style.scrollBehavior = 'auto';
    await rebuild();
    running = true;
    lastTs = 0;
    rafId = requestAnimationFrame(step);
  }

  function stop(){
    running = false;
    if (rafId) cancelAnimationFrame(rafId);
    rafId = null;
  }

  // Pause during touch drag; resume after
  let touchTimer = null;
  track.addEventListener('touchstart', () => { if (touchTimer) clearTimeout(touchTimer); stop(); }, {passive:true});
  track.addEventListener('touchend',   () => {
    if (touchTimer) clearTimeout(touchTimer);
    touchTimer = setTimeout(() => start(), RESUME_TOUCH_DELAY_MS);
  }, {passive:true});

  // Tab visibility
  document.addEventListener('visibilitychange', () => { if (document.hidden) stop(); else start(); });

  // Viewport/orientation
  const onViewportChange = () => { stop(); // fully rebuild for new widths
    unlockWidths(qChildren());
    track.scrollLeft = 0; start(); };

  if (mq.addEventListener) mq.addEventListener('change', onViewportChange);
  else window.addEventListener('resize', onViewportChange);

  // Respect reduced motion
  const prm = window.matchMedia('(prefers-reduced-motion: reduce)');
  if (prm.matches) return; // don’t start
  if (prm.addEventListener) prm.addEventListener('change', e => { e.matches ? stop() : start(); });

  // Go
  start();
})();
</script>


<script>
(function matchHeights(){
  const MQ_MOBILE = 700; // même seuil que ton CSS
  function run(){
    const cards = [...document.querySelectorAll('.services-grid .service-content-box')];
    if (!cards.length) return;

    // remise à zéro
    cards.forEach(c => c.style.minHeight = '');

    // on ne force rien en mobile
    if (window.innerWidth <= MQ_MOBILE) return;

    // prend la + grande hauteur et l’applique à toutes
    const max = Math.max(...cards.map(c => c.offsetHeight));
    cards.forEach(c => c.style.minHeight = Math.ceil(max) + 'px');
  }

  window.addEventListener('load', run);
  window.addEventListener('resize', () => requestAnimationFrame(run));
})();
</script>

<style>
/* ===== Typeahead (look & feel "Twitter typeahead") ===== */
.ta-wrap{ position:relative; display:inline-block; width:min(60vw,400px); }
.ta-input{ width:100%; padding:10px 12px; border:1px solid #ccc; border-radius:8px; }
.ta-list{
  position:absolute; left:0; right:0; top:calc(100% + 6px);
  background:#fff; border:1px solid #ddd; border-radius:8px;
  box-shadow:0 6px 22px rgba(0,0,0,.08); max-height:260px; overflow:auto; z-index:9999; display:none;
}
.ta-item{ padding:10px 12px; cursor:pointer; line-height:1.3; }
.ta-item mark{ background:#FFEBA4; color:inherit; padding:0 2px; border-radius:4px; }
.ta-item small{ display:block; opacity:.7; margin-top:4px; }
.ta-item[aria-selected="true"], .ta-item:hover{ background:#f7f9ff; }
.ta-empty{ padding:10px 12px; color:#888; }
@media (max-width:700px){ .ta-wrap{ width:90vw; } }
</style>

<script>
(function(){
  const track = document.querySelector('.partners-track');
  if (!track) return;

  const mq = window.matchMedia('(max-width: 768px)');
  let running = false, rafId = null, lastTs = 0;
  const SPEED = 40; // px/s (ajuste)
  let cycle = 0;

  // --- util: attendre que TOUTES les images du track soient prêtes
  function imagesReady(){
    const imgs = Array.from(track.querySelectorAll('img'));
    if (imgs.length === 0) return Promise.resolve();
    const waiters = imgs.map(img => {
      if (img.complete && img.naturalWidth > 0) return Promise.resolve();
      return new Promise(res => {
        img.addEventListener('load', res, { once:true });
        img.addEventListener('error', res, { once:true }); // on ne bloque pas si erreur
      });
    });
    return Promise.all(waiters);
  }

  function cleanupClones(){
    track.querySelectorAll('[data-clone="1"]').forEach(n => n.remove());
  }

  function rebuild(){
    cleanupClones();

    // duplique une fois le contenu pour la boucle infinie
    const originals = Array.from(track.children);
    originals.forEach(el => {
      const clone = el.cloneNode(true);
      clone.setAttribute('data-clone','1');
      track.appendChild(clone);
    });

    // forcer un reflow puis mesurer
    void track.offsetWidth;
    const firstClone = track.querySelector('[data-clone="1"]');
    cycle = firstClone ? Math.round(firstClone.offsetLeft) : 0;

    // se replacer au bon endroit dans le cycle
    if (cycle > 0) track.scrollLeft = track.scrollLeft % cycle;
  }

  function shouldRun(){
    return mq.matches && track.scrollWidth > track.clientWidth;
  }

  function step(ts){
    if (!running) return;
    if (!lastTs) lastTs = ts;
    const dt = (ts - lastTs) / 1000;
    lastTs = ts;

    track.scrollLeft += SPEED * dt;

    if (cycle > 0 && track.scrollLeft >= cycle) {
      track.scrollLeft -= cycle;
    }
    rafId = requestAnimationFrame(step);
  }

  async function start(){
    if (running) return;
    // attendre les images (important en prod/CDN)
    await imagesReady();

    // si certaines images arrivent en retard, mets un petit garde-fou
    // qui re-tente tant que les largeurs sont insuffisantes
    let tries = 0;
    while (tries < 8) { // ~8 * 120ms = < 1s
      rebuild();
      if (shouldRun()) break;
      await new Promise(r => setTimeout(r, 120));
      tries++;
    }

    if (!shouldRun()) { stop(); return; }

    running = true;
    lastTs = 0;
    rafId = requestAnimationFrame(step);
  }

  function stop(){
    running = false;
    if (rafId) cancelAnimationFrame(rafId);
    rafId = null;
  }

  // --- interactions & résilience
  // pause au toucher (mobile), reprise ensuite
  let touchTimer = null;
  track.addEventListener('touchstart', () => {
    if (touchTimer) clearTimeout(touchTimer);
    stop();
  }, {passive:true});
  track.addEventListener('touchend', () => {
    if (touchTimer) clearTimeout(touchTimer);
    touchTimer = setTimeout(() => start(), 600);
  }, {passive:true});

  // onglet caché -> pause / visible -> reprise
  document.addEventListener('visibilitychange', () => {
    if (document.hidden) stop(); else start();
  });

  // viewport/responsive
  if (mq.addEventListener) {
    mq.addEventListener('change', () => { stop(); track.scrollLeft = 0; start(); });
  } else if (mq.addListener) {
    mq.addListener(() => { stop(); track.scrollLeft = 0; start(); });
  }
  window.addEventListener('resize', () => { stop(); track.scrollLeft = 0; start(); });

  // si des images se (re)chargent plus tard (cache lent/CDN), on relance
  const ro = new ResizeObserver(() => { stop(); start(); });
  ro.observe(track);

  // Go au DOM prêt
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', start, { once:true });
  } else {
    start();
  }
})();
</script>

<script>
/* === AUTOSUGGEST NENA ADOM (portail, scan pages, sans DB) === */
/* 0) Sélecteurs */
const TA_INPUT_ID = 'searchInput';
const TA_PAGES = [
  { title: "Aides financières", url: "pages/aides.html" },
  { title: "Services à domicile", url: "pages/services.html" },
  { title: "Hospitalisation",   url: "pages/hospitalisation.html" },
  { title: "Pathologies",       url: "pages/pathologie.html" },
  { title: "FAQ",               url: "pages/faq.html" }
];

/* 1) CSS minimal (au cas où) */
(function ensureStyles(){
  if (document.getElementById('ta-styles')) return;
  const css = `
    .ta-portal{position:fixed;z-index:2147483647;display:none;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 6px 22px rgba(0,0,0,.08);max-height:260px;overflow:auto;}
    .ta-item{padding:10px 12px;cursor:pointer;line-height:1.3}
    .ta-item mark{background:#FFEBA4;color:inherit;padding:0 2px;border-radius:4px}
    .ta-item[aria-selected="true"],.ta-item:hover{background:#f7f9ff}
    .ta-empty{padding:10px 12px;color:#888}
  `;
  const s = document.createElement('style'); s.id='ta-styles'; s.textContent=css; document.head.appendChild(s);
})();

/* 2) Construit un index de mots/phrases depuis les pages (cache localStorage) */
async function TA_buildIndex(){
  const KEY='na_typeahead_index_v2';
  try{ const c = localStorage.getItem(KEY); if (c) return JSON.parse(c); }catch(_){}
  const freq = new Map();

  const add = t => {
    const s = (t||'').trim().replace(/\s+/g,' ');
    if (s.length<3) return;
    freq.set(s, (freq.get(s)||0)+1);
  };
  const extract = html => {
    const doc = new DOMParser().parseFromString(html,'text/html');
    const nodes = doc.querySelectorAll('h1,h2,h3,.service-title-box h2,a,strong,[alt]');
    nodes.forEach(n=>{
      const text = (n.getAttribute('alt')||n.textContent||'').trim();
      if (!text) return;
      // garder titres entiers
      if (/^h[1-3]$/i.test(n.tagName) || n.closest('.service-title-box')) add(text);
      // et quelques tokens
      text.split(/[,;:.!?()\/]|(?:\s+-\s+)|\s+/).forEach(w=>{
        if (/^\d+$/.test(w)) return;
        if (w.length>=4) add(w.toLowerCase());
      });
    });
  };

  await Promise.all(TA_PAGES.map(p=>fetch(p.url).then(r=>r.text()).then(extract).catch(()=>{})));

  const list = Array.from(freq.entries())
    .sort((a,b)=> b[1]-a[1] || a[0].localeCompare(b[0]))
    .map(e=>e[0])
    .slice(0,250);

  try{ localStorage.setItem(KEY, JSON.stringify(list)); }catch(_){}
  return list;
}

/* 3) Init autosuggest autour de #searchInput, sans changer ta recherche */
(function TA_init(){
  const input = document.getElementById(TA_INPUT_ID);
  if (!input) return;

  // dropdown en "portail" (toujours au-dessus)
  const list = document.createElement('div');
  list.className = 'ta-portal'; // z-index énorme
  document.body.appendChild(list);

  // positionner sous l'input
  function place(){
    const r = input.getBoundingClientRect();
    list.style.left   = r.left + 'px';
    list.style.top    = (r.bottom + 6) + 'px';
    list.style.width  = r.width + 'px';
  }
  function open(){ list.style.display='block'; place(); }
  function close(){ list.style.display='none'; currentIndex=-1; }
  function isOpen(){ return list.style.display==='block'; }
  window.addEventListener('resize', place);
  window.addEventListener('scroll', place, true);

  let INDEX = [];
  let filtered = [];
  let currentIndex = -1;

  const hi = (label,q)=>{
    if (!q) return label;
    const i = label.toLowerCase().indexOf(q.toLowerCase());
    if (i<0) return label;
    return label.slice(0,i)+'<mark>'+label.slice(i,i+q.length)+'</mark>'+label.slice(i+q.length);
  };

  const filter = q=>{
    if (!q) return INDEX.slice(0,12);
    const ql = q.toLowerCase();
    const starts=[], contains=[];
    for (const s of INDEX){
      const sl=s.toLowerCase();
      if (sl.startsWith(ql)) starts.push(s);
      else if (sl.includes(ql)) contains.push(s);
      if (starts.length+contains.length>=20) break;
    }
    return [...starts,...contains].slice(0,12);
  };

  function render(q){
    filtered = filter(q);
    list.innerHTML='';
    currentIndex=-1;
    if (!filtered.length){
      const empty=document.createElement('div');
      empty.className='ta-item ta-empty';
      empty.textContent='Aucune suggestion';
      list.appendChild(empty);
      return;
    }
    filtered.forEach((s,idx)=>{
      const item=document.createElement('div');
      item.className='ta-item';
      item.setAttribute('data-idx',idx);
      item.innerHTML=hi(s,q);
      item.addEventListener('mousedown', e=>{
        e.preventDefault();
        apply(idx);
      });
      list.appendChild(item);
    });
    place();
  }

  function move(delta){
    const items=list.querySelectorAll('.ta-item:not(.ta-empty)');
    if (!items.length) return;
    currentIndex=(currentIndex+delta+items.length)%items.length;
    items.forEach(el=>el.removeAttribute('aria-selected'));
    items[currentIndex].setAttribute('aria-selected','true');
    items[currentIndex].scrollIntoView({block:'nearest'});
  }

  function apply(idx){
    const choice=filtered[idx];
    if (!choice) return;
    input.value=choice;
    close();
    // on déclenche TA recherche existante
    if (typeof window.searchSite==='function') window.searchSite();
  }

  // events input
  input.addEventListener('input', e=>{
    const q=e.target.value.trim();
    render(q); open();
  });
  input.addEventListener('focus', ()=>{
    render(input.value.trim()); open();
  });
  input.addEventListener('blur', ()=> setTimeout(close,120));
  input.addEventListener('keydown', e=>{
    switch(e.key){
      case 'ArrowDown': e.preventDefault(); if(!isOpen()) open(); move(1); break;
      case 'ArrowUp':   e.preventDefault(); if(!isOpen()) open(); move(-1); break;
      case 'Enter':
        if (isOpen() && currentIndex>=0){ e.preventDefault(); apply(currentIndex); }
        // sinon, laisse ton listener Enter existant appeler searchSite()
        break;
      case 'Escape': close(); break;
    }
  });

  // charger l’index puis proposer
  TA_buildIndex().then(listIdx=>{
    INDEX = (listIdx && listIdx.length) ? listIdx : [];
    if (document.activeElement===input){ render(input.value.trim()); open(); }
  });
})();
</script>

</body>
</html>
